dojo.provide("aipo.blog");dojo.require("aipo.widget.DropdownDatepicker");dojo.require("aipo.widget.MemberNormalSelectList");aipo.blog.toggleMenu=function(f,e,d){var c=e.getBoundingClientRect();var b=document.documentElement.getBoundingClientRect();if(f.style.display=="none"){dojo.query("div.menubar").style("display","none");var a={left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop};f.style.opacity="0";f.style.display="block";if(b.right-f.clientWidth>c.left){f.style.left=c.left+a.left+"px"}else{f.style.left=c.right-f.clientWidth+a.left+"px"}if(b.bottom-f.clientHeight>c.bottom){f.style.top=c.bottom+a.top+"px"}else{f.style.top=c.top-f.clientHeight+a.top+"px"}f.style.opacity=""}else{dojo.query("div.menubar").style("display","none")}};aipo.blog.initFilterSearch=function(b){var c=dojo.byId("q"+b);var a=dojo.byId("filters_"+b);if(a&&c){c.style.paddingLeft=a.offsetWidth+"px"}};aipo.blog.filteredSearch=function(d){var a=dojo.byId("baseuri_"+d).value;var c=[];var f=[];dojo.query("ul.filtertype_"+d,dojo.byId("searchForm_"+d)).forEach(function(h){var i=h.getAttribute("data-type");c.push(i);var g=dojo.query("li.selected",h)[0];if(g){var j=g.getAttribute("data-param");f.push(j)}else{f.push(h.getAttribute("data-defaultparam"))}});var e=dojo.byId("q"+d);var b=e?encodeURIComponent(e.value):"";a+="&filter="+f.join(",");a+="&filtertype="+c.join(",");a+="&keyword="+b;aipo.viewPage(a,d)};aipo.blog.filterSetDefault=function(e,d){var c=dojo.query("ul.filtertype[data-type="+d+"]",dojo.byId("searchForm_"+e))[0];var b=c.getAttribute("data-defaultparam");var a=dojo.query("li[data-param="+b+"]",c);aipo.blog.filterSelect(c,a);aipo.blog.filteredSearch(e)};aipo.blog.filterSelect=function(b,a){dojo.query("li",b).removeClass("selected");dojo.query(a).addClass("selected")};aipo.blog.filterClick=function(d,e,c){var a=e.parentNode;var b=a.parentNode;var f=a.getAttribute("data-param");aipo.blog.filterSelect(b,a);aipo.blog.filteredSearch(d)};aipo.blog.onLoadMsgboardDialog=function(a){var b=dojo.byId("topic_name");if(b){b.focus()}};aipo.blog.onChangeFilter=aipo.blog.onChangeSearch=function(a,c){var b=encodeURIComponent(dojo.byId("q").value);a+="?template=MsgboardTopicListScreen";a+="&filter="+dojo.byId("topic").value;a+="&filtertype=category";a+="&search="+b;aipo.viewPage(a,c)};aipo.blog.showMember=function(a){dojo.byId("Block-GroupMember-Show").style.display="";dojo.byId("is_member").value="TRUE"};aipo.blog.hideMember=function(a){dojo.byId("Block-GroupMember-Show").style.display="none";dojo.byId("member_to").options.length=0;dojo.byId("is_member").value="FALSE"};aipo.blog.onLoadBlogDialog=function(a){var b=dojo.byId("title");if(b){b.focus()}};aipo.blog.onLoadBlogThemaDialog=function(b){var f=dojo.byId("thema_name");if(f){f.focus()}var d=dijit.byId("membernormalselect");if(d){var a=dojo.byId("init_memberlist");var e;var c=a.options;if(c.length==1&&c[0].value==""){return}for(e=0;e<c.length;e++){d.addOptionSync(c[e].value,c[e].text,true)}}};aipo.blog.onLoadBlogDetailDialog=function(a){aipo.portletReload("whatsnew")};aipo.blog.onLoadBlogCommentDialog=function(a){var b=dojo.byId("comment");if(b){b.focus()}aipo.portletReload("whatsnew")};aipo.blog.expandImageWidth=function(a){var b=a.className;if(!b.match(/width_auto/i)){a.className=a.className.replace(/\bwidth_thumbs\b/g,"width_auto")}else{a.className=a.className.replace(/\bwidth_auto\b/g,"width_thumbs")}};aipo.blog.ExpandImage=function(d){var c=new Image();c.src=d;var f=c.width;if(screen.width<c.width){f=screen.width}var e=c.height;if(screen.height<c.height){e=screen.height}var a=(screen.width-f)/2;var g=(screen.height-e)/2;var b=window.open("image","_blank","left=+x+","top=+y+","width=+imwidth+","height=+imheight+","scrollbars=yes","resizable=yes");b.window.document.open();b.window.document.write("<html><head><title>"+c.alt+'</title></head><body style="margin:0;padding:0;border:0;"><img src="'+c.src+'" width="100%" alt="" /></body></html>');b.window.document.close()};aipo.blog.formSwitchThemaInput=function(a){if(a.form.is_new_thema.value=="TRUE"||a.form.is_new_thema.value=="true"){a.value=aimluck.io.escapeText("blog_val_switch1");aipo.blog.formThemaInputOff(a.form)}else{a.value=aimluck.io.escapeText("blog_val_switch2");aipo.blog.formThemaInputOn(a.form)}};aipo.blog.formThemaInputOn=function(a){dojo.byId("blogThemaSelectField").style.display="none";dojo.byId("blogThemaInputField").style.display="";a.is_new_thema.value="TRUE"};aipo.blog.formThemaInputOff=function(a){dojo.byId("blogThemaInputField").style.display="none";dojo.byId("blogThemaSelectField").style.display="";a.is_new_thema.value="FALSE"};aipo.blog.onReceiveMessage=function(d){var a=dojo.byId("attachments_select");if(typeof a!="undefined"&&a!=null){a.parentNode.removeChild(a)}if(!d){var b=dijit.byId("modalDialog");if(b){b.hide()}aipo.portletReload("blog");aipo.portletReload("timeline")}if(dojo.byId("messageDiv")){dojo.byId("messageDiv").innerHTML=d}var c=document.getElementById("modalDialog");if(c&&d!=""){var e=document.getElementById("wrapper");e.style.minHeight=c.clientHeight+"px"}};aipo.blog.onListReceiveMessage=function(b){if(!b){var a=dijit.byId("modalDialog");if(a){a.hide()}aipo.portletReload("blog")}if(dojo.byId("listmessageDiv")){dojo.byId("listmessageDiv").innerHTML=b}};aipo.blog.onSubmitSerchButton=function(c,a,e){var d=a;var b=[["sword",c.sword.value]];aipo.viewPage(d,e,b);if(c.sword.value==""){return false}aipo.viewPage(d,e)};aipo.blog.delCommentReply=function(b,f,c,e){var d=aimluck.io.escapeText("blog_val_confirm1");if(confirm(d)){disableButton(b.form);var a=b.form.action+"&mode=commentdel&"+b.name+"=1&comment_id="+f;aimluck.io.disableForm(b.form,true);aimluck.io.setHiddenValue(b);b.form.action=a;aimluck.io.submit(b.form,c,e,aipo.blog.onReceiveMessage)}};aipo.blog.delBlogEntry=function(b,c,e){var d=aimluck.io.escapeText("blog_val_confirm2");if(confirm(d)){disableButton(b.form);var a=b.form.action+"&mode=delete&"+b.name+"=1";aimluck.io.disableForm(b.form,true);aimluck.io.setHiddenValue(b);b.form.action=a;aimluck.io.submit(b.form,c,e,aipo.blog.onReceiveMessage)}};