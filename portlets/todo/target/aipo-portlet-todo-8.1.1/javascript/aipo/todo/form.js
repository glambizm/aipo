dojo.provide("aipo.todo");dojo.require("aipo.widget.DropdownDatepicker");aipo.todo.toggleMenu=function(f,e,d){var c=e.getBoundingClientRect();var b=document.documentElement.getBoundingClientRect();if(f.style.display=="none"){dojo.query("div.menubar").style("display","none");var a={left:document.documentElement.scrollLeft||document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop};f.style.opacity="0";setTimeout(function(){dojo.style(f,"display","block")},0);if(b.right-f.clientWidth>c.left){f.style.left=c.left+a.left+"px"}else{f.style.left=c.right-f.clientWidth+a.left+"px"}if(b.bottom-f.clientHeight>c.bottom||d){f.style.top=c.bottom+a.top+"px"}else{f.style.top=c.top-f.clientHeight+a.top+"px"}f.style.opacity=""}else{dojo.query("div.menubar").style("display","none")}};aipo.todo.initFilterSearch=function(d){var e=dojo.byId("q"+d);var c=dojo.byId("filters_"+d);if(c&&e){var a=c.offsetWidth;if(aipo.userAgent.isAndroid4_0()){var b=dojo.query("div.filterInputField")[0];var f=parseInt(dojo.getComputedStyle(e).width);b.style.left=a+"px";c.style.left=-a+"px";e.style.width=f-a+"px";b.style.width=f-a+"px";e.style.paddingLeft="2px"}else{if(a!=0){e.style.paddingLeft=a+"px"}}}};aipo.todo.finFilterSearch=function(d){if(aipo.userAgent.isAndroid4_0()){var e=dojo.byId("q"+d);var c=dojo.byId("filters_"+d);if(c&&e){var a=c.offsetWidth;var b=dojo.query("div.filterInputField")[0];var f=parseInt(dojo.getComputedStyle(e).width);b.style.left="0px";c.style.left="0px";e.style.width=f+a+"px";b.style.width=f+a+"px";e.style.paddingLeft=a+2+"px"}}};aipo.todo.filteredSearch=function(d){var b=dojo.byId("baseuri_"+d).value;var c=[];var f=[];dojo.query("ul.filtertype_"+d).forEach(function(h){var i=h.getAttribute("data-type");c.push(i);var g=dojo.query("li.selected",h)[0];if(g){var j=g.getAttribute("data-param");f.push(j)}else{f.push(h.getAttribute("data-defaultparam"))}});var e=dojo.byId("q"+d);var a=[["filter",f.join(",")],["filtertype",c.join(",")],["keyword",e?e.value:""]];aipo.viewPage(b,d,a)};aipo.todo.filterSetDefault=function(e,d){var c=dojo.query("ul.filtertype[data-type="+d+"]")[0];var b=c.getAttribute("data-defaultparam");var a=dojo.query("li[data-param="+b+"]",c);aipo.todo.filterSelect(c,a);aipo.todo.filteredSearch(e)};aipo.todo.filterSelect=function(b,a){dojo.query("li",b).removeClass("selected");dojo.query(a).addClass("selected")};aipo.todo.filterClick=function(d,e,c){var a=e.parentNode;var b=a.parentNode;var f=a.getAttribute("data-param");aipo.todo.filterSelect(b,a);aipo.todo.filteredSearch(d)};aipo.todo.onLoadTodoDialog=function(b){var e=dojo.byId("urlUserlist"+b).value;var c=dojo.byId("loginUser"+b).value;var a=dojo.byId("todoUser"+b).value;if(a==0){a=c}if(e){aipo.todo.changeGroup(e,"LoginUser",a)}var d=dojo.byId("todo_name");if(d){d.focus()}};aipo.todo.onLoadCategoryDialog=function(a){var b=dojo.byId("category_name");if(b){b.focus()}};aipo.todo.formSwitchCategoryInput=function(a){if(a.form.is_new_category.value=="TRUE"||a.form.is_new_category.value=="true"){a.value=aimluck.io.escapeText("todo_val_switch1");aipo.todo.formCategoryInputOff(a.form)}else{a.value=aimluck.io.escapeText("todo_val_switch2");aipo.todo.formCategoryInputOn(a.form)}};aipo.todo.formCategoryInputOn=function(a){dojo.byId("todoCategorySelectField").style.display="none";dojo.byId("todoCategoryInputField").style.display="";a.is_new_category.value="TRUE"};aipo.todo.formCategoryInputOff=function(a){dojo.byId("todoCategoryInputField").style.display="none";dojo.byId("todoCategorySelectField").style.display="";a.is_new_category.value="FALSE"};aipo.todo.changeGroup=function(a,c,b){aimluck.utils.form.createSelect("user_id","destuserDiv",a+"?mode=group&groupname="+c+"&inc_luser=true","userId","aliasName",b,"",'class="w49"')};aipo.todo.onReceiveMessage=function(b){if(!b){var a=dijit.byId("modalDialog");if(a){a.hide()}aipo.portletReload("todo");aipo.portletReload("schedule");aipo.portletReload("timeline")}if(dojo.byId("messageDiv")){dojo.byId("messageDiv").innerHTML=b}};aipo.todo.onListReceiveMessage=function(b){if(!b){var a=dijit.byId("modalDialog");if(a){a.hide()}aipo.portletReload("todo");aipo.portletReload("schedule")}if(dojo.byId("listmessageDiv")){dojo.byId("listmessageDiv").innerHTML=b}};aipo.todo.doKeywordSearch=function(a,b){var c=new Array(2);c[0]=["template","ToDoListScreen"];c[1]=["keyword",dojo.byId("q"+b).value];aipo.viewPage(a,b,c)};