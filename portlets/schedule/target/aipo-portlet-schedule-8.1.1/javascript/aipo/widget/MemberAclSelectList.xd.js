dojo._xdResourceLoaded({depends:[["provide","aipo.widget.MemberAclSelectList"]],defineResource:function(a){if(!a._hasResource["aipo.widget.MemberAclSelectList"]){a._hasResource["aipo.widget.MemberAclSelectList"]=true;a.provide("aipo.widget.MemberAclSelectList");a.require("dijit._Widget");a.require("dijit._Templated");a.declare("aipo.widget.MemberAclSelectList",[dijit._Widget,dijit._Templated],{widgetId:"",memberFromId:"",memberFromUrl:"",memberFromOptionKey:"",memberFromOptionValue:"",memberToTitle:"",memberToId:"",buttonAddId:"",buttonRemoveId:"",memberLimit:0,groupSelectId:"",groupSelectPreOptionKey:"",groupSelectPreOptionValue:"",groupSelectOptionKey:"",groupSelectOptionValue:"",memberGroupUrl:"",changeGroupUrl:"",memberValuesStr:"",memberValues:[],templateString:'<div id="${widgetId}" widgetId="${widgetId}"><table class="none wide mb15"><tbody><tr><td valign="top"><table class="auiRowTable wide mb5"><tbody name="${memberToId}" id="${memberToId}"><tr><th class="thin"><input type="checkbox" onclick="aimluck.io.switchCheckbox(this);"/></th><th class="w50">\u540D\u524D</th><th nowrap="nowrap">\u6A29\u9650</th></tr></tbody></table><input type="button" class="button" value="\u3000\u524A\u9664\u3000" dojoAttachEvent="onclick:onMemberRemoveClick"/></td><td class="thin" valign="top"><select style="width:140px" name="${groupSelectId}" id="${groupSelectId}" dojoAttachEvent="onchange:changeGroup"></select>\n<select size="8" multiple="multiple" style="width:140px" class="mb5" name="${memberFromId}" id="${memberFromId}"></select>\n<input type="button" class="button" value="\u3000\uFF1C \u8FFD\u52A0\u3000" dojoAttachEvent="onclick:onMemberAddClick"/></td></tr></tbody></table></div>\n',postCreate:function(){this.id=this.widgetId;this.memberValues=[];var c=this.memberValuesStr.split(",");for(var e=0;e<c.length;e++){var b=c[e].split(":");var d={};d.key=b[0];d.value=b[1];this.memberValues.push(d)}var f={url:this.memberFromUrl,key:this.memberFromOptionKey,value:this.memberFromOptionValue,preOptions:{key:"ug2",value:"\u005b\u5168\u54e1\u005d"},callback:this.addMemberSync,callbackTarget:this};aimluck.io.createOptions(this.memberFromId,f);f={url:this.memberGroupUrl,key:this.groupSelectOptionKey,value:this.groupSelectOptionValue,preOptions:{key:"all",value:"\u3059\u3079\u3066\u306e\u30e6\u30fc\u30b6\u30fc\u3001\u30b0\u30eb\u30fc\u30d7"}};aimluck.io.createOptions(this.groupSelectId,f)},addMemberSync:function(){var g=a.byId(this.memberFromId);var b=a.byId(this.memberToId);var f=g.options;if(f.length==1&&f[0].value==""){return}for(var h=0;h<f.length;h++){var l=false;var m="1";for(j=0;j<this.memberValues.length;j++){if(this.memberValues[j].key==f[h].value){l=true;m=this.memberValues[j].value;break}}if(!l){continue}var k=document.createElement("tr");k.id="tracldel"+f[h].value;var e=document.createElement("td");e.innerHTML=this.assingValue('<input type="checkbox" id="acldel__ID__" name="acldel" value="__ID__"/>',f[h].value,f[h].text,m);var d=document.createElement("td");d.innerHTML=this.assingValue('<label for="acldel__ID__">__NAME__</label>',f[h].value,f[h].text,m);var c=document.createElement("td");c.setAttribute("nowrap","true");c.nowrap="true";c.innerHTML=this.assingValue('<label><input type="radio" name="acl__ID__" value="1" __CHECKED1__/>\u95b2\u89a7\u306e\u307f</label>&nbsp;<label><input type="radio" name="acl__ID__" value="2" __CHECKED2__/>\u95b2\u89a7\u30fb\u8ffd\u52a0\u30fb\u7de8\u96c6\u30fb\u524a\u9664\u53ef\u80fd</label>',f[h].value,f[h].text,m);k.appendChild(e);k.appendChild(d);k.appendChild(c);b.appendChild(k)}},assingValue:function(c,e,b,d){return c.replace(/__ID__/g,e).replace(/__NAME__/g,b).replace(/__CHECKED1__/g,"1"==d?"checked='checked'":"").replace(/__CHECKED2__/g,"2"==d?"checked='checked'":"")},addMember:function(g,b){var f=g.options;if(f.length==1&&f[0].value==""){return}for(var k=0;k<f.length;k++){if(!f[k].selected){continue}var m=false;for(var h=0;h<this.memberValues.length;h++){if(this.memberValues[h].key==f[k].value){m=true;break}}if(m){continue}var n={};n.key=f[k].value;n.value="1";this.memberValues.push(n);var l=document.createElement("tr");l.id="tracldel"+f[k].value;var e=document.createElement("td");e.innerHTML=this.assingValue('<input type="checkbox" id="acldel__ID__" name="acldel" value="__ID__"/>',f[k].value,f[k].text,"2");var d=document.createElement("td");d.innerHTML=this.assingValue('<label for="acldel__ID__">__NAME__</label>',f[k].value,f[k].text,"2");var c=document.createElement("td");c.setAttribute("nowrap","true");c.nowrap="true";c.innerHTML=this.assingValue('<label><input type="radio" name="acl__ID__" value="1" __CHECKED1__/>\u95b2\u89a7\u306e\u307f</label>&nbsp;<label><input type="radio" name="acl__ID__" value="2" __CHECKED2__/>\u95b2\u89a7\u30fb\u8ffd\u52a0\u30fb\u7de8\u96c6\u30fb\u524a\u9664\u53ef\u80fd</label>',f[k].value,f[k].text,"2");l.appendChild(e);l.appendChild(d);l.appendChild(c);b.appendChild(l)}},removeMember:function(h){var f=[];for(var e=0;e<h.elements.length;e++){var d=h.elements[e];if("acldel"==d.name){if(d.checked){f.push(d)}}}for(var e=0;e<f.length;e++){var b=f[e].id;var g=a.byId("tr"+b);g.parentNode.removeChild(g);for(var c=0;c<this.memberValues.length;c++){if(this.memberValues[c].key==b.replace("acldel","")){this.memberValues.splice(c,1)}}}},changeGroup:function(b){var e=b.target.options[b.target.selectedIndex].value;var c=this.changeGroupUrl+"&groupname="+e;var d={url:c,key:this.memberFromOptionKey,value:this.memberFromOptionValue,indicator:this.widgetId+"-memberlist-indicator"};aimluck.io.createOptions(this.memberFromId,d)},onMemberAddClick:function(b){this.addMember(a.byId(this.memberFromId),a.byId(this.memberToId))},onMemberRemoveClick:function(b){this.removeMember(b.target.form)}})}}});